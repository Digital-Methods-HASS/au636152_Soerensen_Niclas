#Imports 
library(tidyverse)

#Creating an object of all the males in the dataset
men <- subset(Kirkeboger_rettet, Male=="Y")

#Filtering out the men who died before and after 28. juli 1914 and returning their ages
menPre <- subset(men, Day_of_death<'1914-07-28 00:00:00', c(Age))
menDuring <- subset(men, Day_of_death>'1914-07-28 00:00:00', c(Age))

#Calculate average ages 
colMeans(menPre, na.rm = TRUE)
colMeans(menDuring, na.rm = TRUE)


#Calculating total number of deaths pre 28. juli 1914. 
nrOfMenPre <- nrow(menPre)
totalDeathPre <- nrow(subset(Kirkeboger_rettet,Day_of_death<'1914-07-28 00:00:00'))

#Calculating the percentage of male death of pre 28. juli 1914
(nrOfMenPre/totalDeathPre)*100

#Calculating total number of deaths post 28. juli 1914
nrOfMenDuring <- nrow(menDuring)
totalDeathDuring <- nrow(subset(Kirkeboger_rettet,Day_of_death>'1914-07-28 00:00:00'))
(nrOfMenDuring/totalDeathDuring)*100

#Calculating child mortality rate pre and during 28. juli 1914
nrOfDeadChildrenPre <- nrow(subset(menPre, Age<15))
nrOfDeadChildrenDuring <- nrow(subset(menDuring, Age<15))

(nrOfDeadChildrenPre/nrOfMenPre)*100
(nrOfDeadChildrenDuring/nrOfMenDuring)*100
